{"version":3,"file":"gl-google-map.js","sources":["../../../../../src/modules/map/gl-google-map/gl-google-map.js"],"sourcesContent":["/*global google*/\nimport { registerComponents } from '../../common/register-components.js';\nimport { GlGoogleMarker } from '../gl-google-marker/gl-google-marker.js';\n\n/**\n * @injectHTML\n */\nexport class GlGoogleMap extends HTMLElement {\n    static get observedAttributes() {\n        return [\n            'key',\n            'latitude',\n            'longitude',\n            'overlay',\n            'map-style',\n            'show-markers',\n            'show-kml',\n            'show-image',\n        ];\n    }\n\n    static async getStyle(url) {\n        const repsonse = await fetch(url);\n        const json = await repsonse.json();\n\n        return json;\n    }\n\n    constructor() {\n        super();\n\n        registerComponents(GlGoogleMarker);\n\n        this.isAdmin = true;\n        this.key = '';\n        this._id = crypto.randomUUID ? crypto.randomUUID().split('-').pop() : Math.round(Math.random() * 9999);\n        this._imageElem = this.querySelector('img');\n        this._markerElems = [...this.querySelectorAll('gl-google-marker')];\n        this._markers = [];\n        this._adminMarkers = [];\n        this.apiLoadedCBName = `gl_cb_${this._id}`;\n        this.map = undefined;\n        this.styleLayer = undefined;\n        this.imageLayer = undefined;\n        this.imageNE = 0.0;\n        this.imageNW = 0.0;\n        this.imageSW = 0.0;\n        this.imageSE = 0.0;\n        this.kmlLayer = undefined;\n        this.elem = this.shadowRoot.querySelector('.gl-map');\n        this.mapElem = this.shadowRoot.querySelector('.gl-map__map');\n        this.detailElem = null;\n\n        this.elem.setAttribute('id', `map_${this._id}`);\n\n        this.generateAdminMarker = this.generateAdminMarker.bind(this);\n        this.generateMarker = this.generateMarker.bind(this);\n        this.loadDetail = this.loadDetail.bind(this);\n    }\n\n    get isMarkersVisible() {\n        return this.getAttribute('show-markers') === 'true';\n    }\n\n    set isMarkersVisible(val) {\n        this.setAttribute('show-markers', val);\n    }\n\n    get isKmlVisible() {\n        return this.getAttribute('show-kml') === 'true';\n    }\n\n    set isKmlVisible(val) {\n        this.setAttribute('show-kml', val);\n    }\n\n    get isImageVisible() {\n        return this.getAttribute('show-image') === 'true';\n    }\n\n    set isImageVisible(val) {\n        this.setAttribute('show-image', val);\n    }\n\n    get latitude() {\n        const latitude = parseFloat(this.hasAttribute('latitude') ? this.getAttribute('latitude') : '0');\n        return  isNaN(latitude) ? 0 : latitude;\n    }\n\n    get longitude() {\n        const longitude = parseFloat(this.hasAttribute('longitude') ? this.getAttribute('longitude') : '0');\n        return  isNaN(longitude) ? 0 : longitude;\n    }\n\n    get overlay() {\n        return this.getAttribute('overlay');\n    }\n\n    get mapStyle() {\n        return this.getAttribute('map-style');\n    }\n\n    get markerElems() {\n        return [...this._markerElems];\n    }\n\n    get imageElemPosition() {\n        const neLatitude = parseFloat(this._imageElem.getAttribute('latitude-ne'));\n        const neLongitude = parseFloat(this._imageElem.getAttribute('longitude-ne'));\n        const swLatitude = parseFloat(this._imageElem.getAttribute('latitude-sw'));\n        const swLongitude = parseFloat(this._imageElem.getAttribute('longitude-sw'));\n\n        return {\n            neLatitude: isNaN(neLatitude) ? 0.00 : neLatitude,\n            neLongitude: isNaN(neLongitude) ? 0.00 : neLongitude,\n            swLatitude: isNaN(swLatitude) ? 0.00 : swLatitude,\n            swLongitude: isNaN(swLongitude) ? 0.00 : swLongitude\n        };\n    }\n\n    set imageElemPosition(val) {\n        this._imageElem.setAttribute('latitude-ne', val.neLatitude);\n        this._imageElem.setAttribute('longitude-ne', val.neLongitude);\n        this._imageElem.setAttribute('latitude-sw', val.swLatitude);\n        this._imageElem.setAttribute('longitude-sw', val.swLongitude);\n\n        if (google && google.maps && this.imageLayer) {\n            const bounds = new google.maps.LatLngBounds(\n                new google.maps.LatLng(val.neLatitude, val.neLongitude),\n                new google.maps.LatLng(val.swLatitude, val.swLongitude)\n            );\n            this.imageLayer.setBounds(bounds);\n            this.imageLayer.draw();\n        }\n    }\n\n    get adminMarkers() {\n        return this._adminMarkers;\n    }\n\n    set adminMarkers(arr) {\n        this._adminMarkers = Array.isArray(arr) ? arr.map(this.generateAdminMarker) : [];\n    }\n\n    get markers() {\n        return this._markers;\n    }\n\n    set markers(markers) {\n        if (this.map && google && google.maps) {\n            this._markers = [\n                ...this.adminMarkers,\n                ...markers.map(this.generateMarker)\n            ];\n        } else {\n            this._markers = [...this.adminMarkers];\n        }\n    }\n\n    /**\n     * @todo This should be an async function.\n     * Need a way to know when everything has been loaded and\n     * drawn before actually displaying the map.\n     */\n    handleApiLoaded() {\n        this.map = new google.maps.Map(this.mapElem, {\n            center: { lat: this.latitude, lng: this.longitude },\n            mapTypeControl: false,\n            scaleControl: false,\n            streetViewControl: false,\n            fullscreenControl: false,\n            zoom: 8\n        });\n        this.setMapStyle();\n        this.placeImages();\n        this.generateKml();\n        this.markers = this.markerElems;\n    }\n\n    async placeImages() {\n        const imageUrl = this._imageElem.getAttribute('src');\n        const neLatitude = this.imageElemPosition.neLatitude;\n        const neLongitude = this.imageElemPosition.neLongitude;\n        const swLatitude = this.imageElemPosition.swLatitude;\n        const swLongitude = this.imageElemPosition.swLongitude;\n        const bounds = new google.maps.LatLngBounds(\n            new google.maps.LatLng(neLatitude, neLongitude),\n            new google.maps.LatLng(swLatitude, swLongitude)\n        );\n\n        this.adminMarkers = [\n            { label: 'ne', latitude: neLatitude, longitude: neLongitude },\n            { label: 'sw', latitude: swLatitude, longitude: swLongitude },\n        ];\n\n        if (!imageUrl) {\n            return;\n        }\n\n        GlGoogleImage.prototype = new google.maps.OverlayView();\n        function GlGoogleImage(bounds, image, map) {\n            this._bounds = bounds;\n            this._imageElem = image;\n            this._map = map;\n            this._div = undefined;\n\n            this.setMap(map);\n        }\n\n        GlGoogleImage.prototype.setBounds = function(bounds) {\n            this._bounds = bounds;\n        };\n\n        GlGoogleImage.prototype.onAdd = function() {\n            const panes = this.getPanes();\n\n            this._div = document.createElement('div');\n            // this._div.style.borderStyle = 'none';\n            // this._div.style.borderWidth = '0';\n            this._div.style.border = '2px solid red';\n            this._div.style.position = 'absolute';\n\n            this._imageElem.parentNode.removeChild(this._imageElem);\n            this._imageElem.style.width = '100%';\n            this._imageElem.style.height = '100%';\n            this._imageElem.style.position = 'absolute';\n            this._imageElem.style.display = 'block';\n            this._div.appendChild(this._imageElem);\n\n            // For draggable positioning, we'll use `floatPane` instead of `overlayLayer`\n            panes.overlayLayer.appendChild(this._div);\n        };\n\n        GlGoogleImage.prototype.draw = function(bounds) {\n            const overlayProjection = this.getProjection();\n            const boundsNE = bounds ? bounds.getNorthEast() : this._bounds.getNorthEast();\n            const boundsSW = bounds ? bounds.getSouthWest() : this._bounds.getSouthWest();\n            const sw = overlayProjection.fromLatLngToDivPixel(boundsSW);\n            const ne = overlayProjection.fromLatLngToDivPixel(boundsNE);\n\n            if (this._div) {\n                this._div.style.top = `${sw.y}px`;\n                this._div.style.left = `${ne.x}px`;\n                this._div.style.width = `${sw.x - ne.x}px`;\n                this._div.style.height = `${ne.y - sw.y}px`;\n            }\n        };\n\n        GlGoogleImage.prototype.onRemove = function() {\n            if (this._div) {\n                this._div.parentNode.removeChild(this._div);\n                this._div = null;\n            }\n        };\n\n\n        this.imageLayer = new GlGoogleImage(bounds, this._imageElem, this.map);\n        this.imageLayer.setMap(this.map);\n    }\n\n    async setMapStyle() {\n        const mapStyle = await GlGoogleMap.getStyle(this.mapStyle);\n\n        if (mapStyle) {\n            this.styleLayer = new google.maps.StyledMapType(mapStyle, { name: `Map${this._id}` });\n            this.map.mapTypes.set(`map_${this._id}`, this.styleLayer);\n            this.map.setMapTypeId(`map_${this._id}`);\n        }\n    }\n\n    generateKml() {\n        this.kmlLayer = new google.maps.KmlLayer({\n            url: this.overlay,\n            map: this.map,\n            suppressInfoWindows: true,\n        });\n    }\n\n    generateAdminMarker(marker) {\n        const adminMarker = new google.maps.Marker({\n            map: this.map,\n            type: 'admin',\n            position: { lat: marker.latitude, lng: marker.longitude },\n            icon: {\n                path: 'M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z',\n                scale: 1,\n                fillColor: 'white',\n                strokeColor: 'white',\n                fillOpacity: 0.8,\n                strokeWeight: 2,\n                anchor: new google.maps.Point(10, 10)\n            },\n            draggable: true\n        });\n\n        adminMarker.addListener('dragstart', (event) => {\n            console.log('drag began', event);\n        });\n        adminMarker.addListener('drag', (event) => {\n            const label = marker.label;\n            const lat = event.latLng.lat();\n            const lng = event.latLng.lng();\n\n            this.imageElemPosition = {\n                neLatitude: (label === 'nw' || label === 'ne') ? lat : this.imageElemPosition.neLatitude,\n                neLongitude: (label === 'nw' || label === 'ne') ? lng : this.imageElemPosition.neLongitude,\n                swLatitude: (label === 'sw' || label == 'se') ? lat : this.imageElemPosition.swLatitude,\n                swLongitude: (label === 'sw' || label == 'se') ? lng : this.imageElemPosition.swLongitude,\n            };\n        });\n        adminMarker.addListener('dragend', (event) => {\n            console.log('drag finished', event);\n        });\n        return adminMarker;\n    }\n\n    generateMarker(marker) {\n        const mapMarker = new google.maps.Marker({\n            map: this.map,\n            id: marker.id,\n            type: 'client',\n            position: { lat: marker.latitude, lng: marker.longitude },\n            icon: {\n                path: 'M10 0c5.52285 0 10 4.47715 10 10 0 7.50794-5.59957 12.48988-10 12.48988S0 17.78101 0 10C0 4.47715 4.47715 0 10 0Zm0 3.4743c-3.60404 0-6.5257 2.92166-6.5257 6.5257 0 3.60404 2.92166 6.5257 6.5257 6.5257 3.60404 0 6.5257-2.92166 6.5257-6.5257 0-3.60404-2.92166-6.5257-6.5257-6.5257Zm0 3.0039c1.94504 0 3.5218 1.57676 3.5218 3.5218 0 1.94504-1.57676 3.5218-3.5218 3.5218-1.94504 0-3.5218-1.57676-3.5218-3.5218 0-1.94504 1.57676-3.5218 3.5218-3.5218Z',\n                fillColor: 'red',\n                fillOpacity: 0.6,\n                strokeWeight: 0,\n                anchor: new google.maps.Point(10, 22)\n            },\n            animation: google.maps.Animation.DROP,\n            draggable: true,\n        });\n        mapMarker.addListener('mouseover', () => {\n            mapMarker.setIcon({\n                path: 'M10 0c5.52285 0 10 4.47715 10 10 0 7.50794-5.59957 12.48988-10 12.48988S0 17.78101 0 10C0 4.47715 4.47715 0 10 0Zm0 3.4743c-3.60404 0-6.5257 2.92166-6.5257 6.5257 0 3.60404 2.92166 6.5257 6.5257 6.5257 3.60404 0 6.5257-2.92166 6.5257-6.5257 0-3.60404-2.92166-6.5257-6.5257-6.5257Zm0 3.0039c1.94504 0 3.5218 1.57676 3.5218 3.5218 0 1.94504-1.57676 3.5218-3.5218 3.5218-1.94504 0-3.5218-1.57676-3.5218-3.5218 0-1.94504 1.57676-3.5218 3.5218-3.5218Z',\n                fillColor: 'red',\n                fillOpacity: 1,\n                strokeWeight: 0,\n                anchor: new google.maps.Point(10, 22)\n            });\n        });\n        mapMarker.addListener('mouseout', () => {\n            mapMarker.setIcon({\n                path: 'M10 0c5.52285 0 10 4.47715 10 10 0 7.50794-5.59957 12.48988-10 12.48988S0 17.78101 0 10C0 4.47715 4.47715 0 10 0Zm0 3.4743c-3.60404 0-6.5257 2.92166-6.5257 6.5257 0 3.60404 2.92166 6.5257 6.5257 6.5257 3.60404 0 6.5257-2.92166 6.5257-6.5257 0-3.60404-2.92166-6.5257-6.5257-6.5257Zm0 3.0039c1.94504 0 3.5218 1.57676 3.5218 3.5218 0 1.94504-1.57676 3.5218-3.5218 3.5218-1.94504 0-3.5218-1.57676-3.5218-3.5218 0-1.94504 1.57676-3.5218 3.5218-3.5218Z',\n                fillColor: 'red',\n                fillOpacity: 0.6,\n                strokeWeight: 0,\n                anchor: new google.maps.Point(10, 22)\n            });\n        });\n        mapMarker.addListener('dragend', (event) => {\n            const dragendEvent = new CustomEvent('dragend', {\n                detail: {\n                    map: this.map,\n                    marker: mapMarker,\n                    position: {\n                        latitude: event.latLng.lat(),\n                        longitude: event.latLng.lng()\n                    }\n                }\n            });\n            this.dispatchEvent(dragendEvent);\n        });\n\n        mapMarker.addListener('click', () => {\n            this.loadDetail(mapMarker);\n        });\n\n        return mapMarker;\n    }\n\n    generateDetail() {\n        const detailElem = document.createElement('div');\n        const contentElem = document.createElement('div');\n        const closeElem = document.createElement('button');\n\n        closeElem.setAttribute('type', 'button');\n        closeElem.className = 'gl-map__detail-close';\n        closeElem.innerHTML = '&times;';\n        closeElem.addEventListener('click', this.closeDetail.bind(this), false);\n\n        contentElem.className = 'gl-map__detail-content';\n\n        detailElem.className = 'gl-map__detail';\n        detailElem.appendChild(contentElem);\n        detailElem.appendChild(closeElem);\n\n        this.elem.appendChild(detailElem);\n        this.detailElem = detailElem;\n        this.detailContentElem = contentElem;\n    }\n\n    loadDetail(marker) {\n        const markerElem = this.markerElems.find(elem => elem.id === marker.id);\n        const markerElemChildren = markerElem ? [...markerElem.children] : [];\n\n        this.elem.classList.remove('has-detail');\n\n        if (!this.detailElem) {\n            this.generateDetail();\n        }\n\n        while (this.detailContentElem.firstChild) {\n            this.detailContentElem.removeChild(this.detailContentElem.lastChild);\n            console.log('removing child');\n        }\n\n        markerElemChildren.forEach((child) => {\n            this.detailContentElem.appendChild(child.cloneNode(true));\n        });\n\n        this.elem.classList.add('has-detail');\n    }\n\n    closeDetail() {\n        this.elem.classList.remove('has-detail');\n    }\n\n    loadGoogleMapsApi() {\n        const endpoint = 'https://maps.googleapis.com/maps/api/js';\n        const script = document.createElement('script');\n        script.id = `map_script_${this._id}`;\n        script.type = 'text/javascript';\n        script.src = `${endpoint}?key=${this.key}&callback=${this.apiLoadedCBName}&v=weekly`;\n        script.defer = true;\n        script.async = true;\n        window[this.apiLoadedCBName] = this.handleApiLoaded.bind(this);\n        document.head.appendChild(script);\n    }\n\n    /**\n     * Fires when the component is connected to the DOM\n     */\n    connectedCallback() {\n        this._markerElems = this.querySelectorAll('gl-google-marker');\n    }\n\n    adoptedCallback() {\n        this._markerElems = this.querySelectorAll('gl-google-marker');\n    }\n\n    /**\n     * Handles changes to the component attributes\n     * @param {String} name\n     * @param {String} oldValue\n     * @param {String} newValue\n     */\n    attributeChangedCallback(name, oldValue, newValue) {\n        if (name === 'key' && newValue) {\n            this.key = newValue;\n            this.removeAttribute('key');\n            this.loadGoogleMapsApi();\n        }\n\n        if (name === 'show-markers') {\n            this.markers.forEach((marker) => {\n                if (marker.type === 'client') {\n                    marker.setVisible(this.isMarkersVisible);\n                }\n            });\n        }\n\n        if (name === 'show-kml') {\n            this.kmlLayer.setMap(this.isKmlVisible ? this.map : null);\n        }\n\n        if (name === 'show-image') {\n            this.imageLayer.setMap(this.isImageVisible ? this.map : null);\n            this.markers.forEach((marker) => {\n                if (marker.type === 'admin') {\n                    marker.setVisible(this.isImageVisible);\n                }\n            });\n        }\n    }\n}\n\nif (!window.customElements.get('gl-google-map')) {\n    window.customElements.define('gl-google-map', GlGoogleMap);\n}\n"],"names":["GlGoogleMap","HTMLElement","observedAttributes","static","url","repsonse","fetch","json","constructor","super","el","document","createElement","innerHTML","this","attachShadow","mode","shadowRoot","appendChild","content","cloneNode","registerComponents","GlGoogleMarker","isAdmin","key","_id","crypto","randomUUID","split","pop","Math","round","random","_imageElem","querySelector","_markerElems","querySelectorAll","_markers","_adminMarkers","apiLoadedCBName","map","undefined","styleLayer","imageLayer","imageNE","imageNW","imageSW","imageSE","kmlLayer","elem","mapElem","detailElem","setAttribute","generateAdminMarker","bind","generateMarker","loadDetail","isMarkersVisible","getAttribute","val","isKmlVisible","isImageVisible","latitude","parseFloat","hasAttribute","isNaN","longitude","overlay","mapStyle","markerElems","imageElemPosition","neLatitude","neLongitude","swLatitude","swLongitude","google","maps","bounds","LatLngBounds","LatLng","setBounds","draw","adminMarkers","arr","Array","isArray","markers","handleApiLoaded","Map","center","lat","lng","mapTypeControl","scaleControl","streetViewControl","fullscreenControl","zoom","setMapStyle","placeImages","generateKml","async","imageUrl","GlGoogleImage","image","_bounds","_map","_div","setMap","label","prototype","OverlayView","onAdd","panes","getPanes","style","border","position","parentNode","removeChild","width","height","display","overlayLayer","overlayProjection","getProjection","boundsNE","getNorthEast","boundsSW","getSouthWest","sw","fromLatLngToDivPixel","ne","top","y","left","x","onRemove","getStyle","StyledMapType","name","mapTypes","set","setMapTypeId","KmlLayer","suppressInfoWindows","marker","adminMarker","Marker","type","icon","path","scale","fillColor","strokeColor","fillOpacity","strokeWeight","anchor","Point","draggable","addListener","event","console","log","latLng","mapMarker","id","animation","Animation","DROP","setIcon","dragendEvent","CustomEvent","detail","dispatchEvent","generateDetail","contentElem","closeElem","className","addEventListener","closeDetail","detailContentElem","markerElem","find","markerElemChildren","children","classList","remove","firstChild","lastChild","forEach","child","add","loadGoogleMapsApi","script","src","defer","window","head","connectedCallback","adoptedCallback","attributeChangedCallback","oldValue","newValue","removeAttribute","setVisible","customElements","get","define"],"mappings":"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"}